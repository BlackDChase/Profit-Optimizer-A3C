 0%|                                                                                       | 0/100 [00:00<?, ?it/s]/home/black/.local/lib/python3.8/site-packages/torch/nn/modules/container.py:117: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  input = module(input)
  1%|▊                                                                              | 1/100 [00:00<00:26,  3.72it/s]/home/black/.local/lib/python3.8/site-packages/torch/autograd/__init__.py:130: UserWarning: Error detected in MmBackward. Traceback of forward call that caused the error:
  File "main.py", line 25, in <module>
    god.train()
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 139, in train
    self.__trainBoss()
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 246, in __trainBoss
    self.__bossAgent[0].train()
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 304, in train
    self.gatherAndStore()
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 337, in gatherAndStore
    action,actionProb = self.getAction(currentState)
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 358, in getAction
    actionProb = self.god._getAction(state)
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 184, in _getAction
    actionProbab = self.__policyNet.forward(state)
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/NeuralNet.py", line 120, in forward
    output = self.model(currentState)
  File "/home/black/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/black/.local/lib/python3.8/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/home/black/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/black/.local/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 93, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/black/.local/lib/python3.8/site-packages/torch/nn/functional.py", line 1692, in linear
    output = input.matmul(weight.t())
 (Triggered internally at  /pytorch/torch/csrc/autograd/python_anomaly_mode.cpp:104.)
  Variable._execution_engine.run_backward(
  1%|▊                                                                              | 1/100 [00:00<00:48,  2.04it/s]
Terminated, check log  Sat-03-04-21
Traceback (most recent call last):
  File "main.py", line 30, in <module>
    raise catch
  File "main.py", line 25, in <module>
    god.train()
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 139, in train
    self.__trainBoss()
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 246, in __trainBoss
    self.__bossAgent[0].train()
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 319, in train
    self.calculateAndUpdateL_P()
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 460, in calculateAndUpdateL_P
    self.god._updatePolicy(loss)
  File "/media/black/Data/GIT/OptimizeDemandResponse/Profit-Optimizer-A3C/modules/Agent.py", line 143, in _updatePolicy
    loss.backward(retain_graph=True)
  File "/home/black/.local/lib/python3.8/site-packages/torch/tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/home/black/.local/lib/python3.8/site-packages/torch/autograd/__init__.py", line 130, in backward
    Variable._execution_engine.run_backward(
RuntimeError: one of the variables needed for gradient computation has been modified by an inpace operation: [torch.FloatTensor [50, 11]], which is output 0 of TBackward, is at version 2; expected version 1 instead. Hint: the backtrace further above shows the operation that failed to compute its gradient. The variable in question was changed in there or anywhere later. Good luck! FUCK YOU BIRIBIRI!
